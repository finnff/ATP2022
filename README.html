<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>README</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<h1 id="finnff-atp-bezem-2223">finnff ATP Bezem 22/23</h1>
<h1 id="project--en-testplan">Project- en Testplan</h1>
<ul>
<li>zie /projectTestPlan/</li>
</ul>
<h1 id="eindopdracht-testrapport">Eindopdracht Testrapport</h1>
<p>zie hiervoor <a
href="https://github.com/finnff/ATP2022/blob/main/tests/README.md">tests/README.md</a></p>
<hr />
<h1 id="eindopdracht">Eindopdracht</h1>
<h2 id="requirements">Requirements:</h2>
<ul>
<li>redis-server</li>
<li>tmux voor startscript (maar anders in de volgorde van
./src/start_script.sh elke python file openen werkt ook)</li>
</ul>
<figure>
<img src="img/2023-08-31-18-29-31.png" alt="img" />
<figcaption aria-hidden="true">img</figcaption>
</figure>
<figure>
<img src="img/2023-08-31-18-21-21.png" alt="img" />
<figcaption aria-hidden="true">img</figcaption>
</figure>
<h2 id="uitleg-per-file">Uitleg per file:</h2>
<h4 id="srccarparamsmanager.py">src/CarParamsManager.py</h4>
<p>Is verantwoordelijk voor het laden van de car parameters (zie
./car_constants/) in redis, en zorgt ervoor dat we van auto kunnen
verwisselen.</p>
<h4 id="srccombined_interface.py">src/combined_interface.py</h4>
<p>Dit is de interface waar de FRP cpu voornamelijk mee interacteerd,
hier binnnen is het nog een wrapper functie voor de twee actuators en
zowel de speedSensor, radar sensor en het gas + rem pedaal</p>
<h4 id="srcdashboard.py">src/dashboard.py</h4>
<p>Een Flask / plotly / dash live dashboard, waarmee we de huidige
waardes + kunnen laten zien</p>
<h4 id="srcfrpcpu.py">src/frpCPU.py</h4>
<p>De functional reactive python geprogrameerde CPU, die de PID/BangBang
controller aanstuurt (door define boven aan file), hier naast is er ook
2 aspect oriented wrappers (en een die naar file logged: hieruit leest
dashboard (via combined_interface) weer interne waardes van FRP/pid
uit)</p>
<h4 id="srcinputreality.py">src/inputReality.py</h4>
<p>Deze file zorgt er voor dat we inputs kunnen geven aan de simulator,
en custom testcases kunnen maken / automatisch genereren en runnen. deze
zet ook de RESET_FLAG en CRASHED_FLAG zodat we meerdere runs kunnen
doen.</p>
<h4 id="srcreality.py">src/reality.py</h4>
<p>Hoofd deel van de siumlator: deze bevat de update loops,
expirimentele time scaling ( versnellen/vertragen werkt niet echt goed
omdat de FRP observables interval hiermee zou moeten mee scalen dus
staat op realtime) en simuleert de werkelijkheid en dus ook abstracties
van de frontRadarSensor en de WheelSpeedsensor.</p>
<h4 id="srcwheelspeedcpp">src/WheelSpeedCPP/</h4>
<p>Python Binding naar C++, reader.py is een demo qua usecase,
combined_interface gebruikt direct de binary .SO file. de code voor het
maken hiervan is gedaan met Pybind11, de implemtatie staat in
./WheelSpeedCPP/aaaa/aaaa.cpp, om te builden heb je wel de
<code>usr/lib64/libhiredis.so</code> en
<code>usr/include/hiredis/hiredis.h</code> nodig (download via package
manager en pas zo nodig de cmake paths aan) om dat de C++ binding na het
ontvangen van CPR en Diameter setters data leest van Redis , en deze
vervolgens ge Get() kan worden. Voor meer info zie de README van
/tests/</p>
<h4 id="redis-controller-.redis-memory-remote">Redis controller
‘./redis-memory-remote’</h4>
<p>Redis is een RAM based key-value store dat we gebruiken voor
inter-process communication in onze simulator Regelsysteem. (Websockets
was te langzaam/onstabiel)</p>
<p>Alle data is opgeslagen in RAM voor snelle read write performance,
maar Redis heeft persistence features, dus deze data wordt gesaved naar
Harddrive blijft bestaan na sluiten applicatie of na reboots. Hiervoor
heb ik een Tool gemaakt:</p>
<h4 id="usage">Usage:</h4>
<ol type="1">
<li><code>chmod +x redis-memory-remote</code></li>
<li><code>./redis-memory-remote</code></li>
</ol>
<ul>
<li><strong>View Data</strong>: Interactive UI to browse Redis keys, use
<code>arrow keys, Enter and Esc</code></li>
<li><strong>Reset Data</strong>: Reset keys to default values.
<code>Shift+R</code> or from cli:
<code>./redis-memory-remote -R</code></li>
<li><strong>Flush Data</strong>: (<strong>Unstable!</strong>) Remove all
data from Redis. <code>Shift+F</code> or from cli:
<code>./redis-memory-remote -F</code></li>
</ul>
<p>Note: Flush (basically SQL Droptable) heeft nogal de neiging om
raceconditions en crashes te veroorzaken zeker voor de C++ binding dus
het is meestal voldoende om tijdens runnen aleen te reseten naar default
Waardes voor de simulator/testing</p>
</body>
</html>
